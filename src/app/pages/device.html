<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="View details about your device" />
		<title>Warden device</title>
		<style></style>
	</head>
	<body
		class="font-sans min-h-dvh flex flex-col m-0 text-base leading-none text-black dark:text-white background-white dark:background-black scheme-light-dark"
		onload="loadDevice()"
	>
		<notifications ref="./src/app/components/notifications.html" />
		<header class="sticky top-0 w-full background-neutral-100 dark:background-neutral-900 z-4">
			<nav
				class="flex flex-row gap-2 sm:gap-3 lg:gap-4 pt-2 sm:pt-3 lg:pt-4 pr-4 sm:pr-6 lg:pr-8 pb-2 sm:pb-3 lg:pb-4 pl-4 sm:pl-6 lg:pl-8 text-lg font-normal overflow-x-auto scrollbar-none"
			>
				<a href="/" class="no-underline text-black dark:text-white">Home</a>
				<a href="/devices" class="no-underline text-black dark:text-white">Devices</a>
				<a href="/zones" class="no-underline text-black dark:text-white">Zones</a>
				<a href="/uplinks" class="no-underline text-black dark:text-white">Uplinks</a>
				<a href="/downlinks" class="no-underline text-black dark:text-white">Downlinks</a>
				<a href="/users" class="no-underline text-black dark:text-white">Users</a>
			</nav>
		</header>
		<main class="flex flex-col grow m-4 sm:m-6 lg:m-8">
			<div
				class="flex flex-row items-center justify-between gap-2 sm:gap-3 lg:gap-4 border-0 border-b-1 border-solid border-b-neutral-400 dark:border-b-neutral-600"
			>
				<div id="tabs" class="flex gap-2 sm:gap-3 lg:gap-4 m-0 pt-2 sm:pt-3 lg:pt-4 pb-2 sm:pb-3 lg:pb-4 text-base font-normal overflow-x-auto scrollbar-none">
					<a class="no-underline text-blue-600 dark:text-blue-400">Details</a>
					<a class="no-underline text-black dark:text-white">Readings</a>
					<a class="no-underline text-black dark:text-white">Metrics</a>
					<a class="no-underline text-black dark:text-white">Buffers</a>
					<a class="no-underline text-black dark:text-white">Signals</a>
					<a class="no-underline text-black dark:text-white">Uplinks</a>
					<a class="no-underline text-black dark:text-white">Downlinks</a>
				</div>
				<div id="update">
					<icon-edit ref="./src/app/components/icon-edit.html" />
				</div>
			</div>
			<div class="overflow-x-auto scrollbar-none">
				<table class="w-full text-nowrap border-collapse">
					<tbody id="device">
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Id</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="font-mono m-0 w-80 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Name</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-32 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Zone</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-16 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Firmware</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-16 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Hardware</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-16 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Created at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Updated at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Temperature</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-12 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Humidity</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-12 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Captured at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Photovoltaic</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-12 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Battery</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-12 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Captured at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Delay</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-12 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Level</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-12 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Captured at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Uplink id</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="font-mono m-0 w-80 h-4 text-blue-600 dark:text-blue-400 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Received at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			<dialog id="update-dialog" class="w-full max-w-96 p-0 border-0 text-black dark:text-white background-neutral-100 dark:background-neutral-900">
				<form class="m-4 flex flex-col gap-4" onsubmit="updateForm.handleSubmit(event)">
					<h1 class="m-0 text-xl font-medium">Update device?</h1>
					<div class="w-full flex flex-col items-start">
						<label for="update-name" class="mb-2 text-base font-normal">Name</label>
						<input
							id="update-name"
							type="text"
							class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
							placeholder="name"
							autofocus
							onchange="updateForm.setValue('name', event.target.value)"
							onblur="updateForm.setTouched('name', true)"
						/>
						<p id="update-name-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
					</div>
					<div class="w-full flex flex-col items-start">
						<label for="update-zone-id" class="mb-2 text-base font-normal">Zone id</label>
						<input
							id="update-zone-id"
							type="text"
							class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
							placeholder="zone id"
							onchange="updateForm.setValue('zoneId', event.target.value)"
							onblur="updateForm.setTouched('zoneId', true)"
						/>
						<p id="update-zone-id-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
					</div>
					<div class="flex flex-row-reverse justify-start gap-2">
						<button
							id="update-button"
							type="submit"
							class="min-w-28 h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-blue-300 dark:background-blue-700 outline-none cursor-pointer"
						>
							Update
						</button>
						<button
							class="min-w-28 h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-300 dark:background-neutral-700 outline-none cursor-pointer"
							type="button"
							onclick="closeUpdateDialog()"
						>
							Cancel
						</button>
					</div>
				</form>
			</dialog>
		</main>
		<footer class="w-full background-neutral-100 dark:background-neutral-900">
			<div
				class="flex flex-row justify-between gap-2 sm:gap-3 lg:gap-4 pt-2 sm:pt-3 lg:pt-4 pr-4 sm:pr-6 lg:pr-8 pb-2 sm:pb-3 lg:pb-4 pl-4 sm:pl-6 lg:pl-8 text-lg font-normal text-nowrap overflow-x-auto scrollbar-none"
			>
				<p class="m-0 text-xs font-normal text-neutral-400 dark:text-neutral-600">warden {version} {commit}</p>
				<p class="m-0 text-xs font-normal text-neutral-400 dark:text-neutral-600">written by simylein</p>
			</div>
		</footer>
	</body>
	<script>
		import './src/app/scripts/duration.js';
		import './src/app/scripts/device-tabs.js';
		import './src/app/scripts/state.js';
		import './src/app/scripts/timestamp.js';
		import './src/app/scripts/fade.js';
		import './src/app/scripts/color-null.js';
		import './src/app/scripts/color-device.js';
		import './src/app/scripts/color-reading.js';
		import './src/app/scripts/color-metric.js';
		import './src/app/scripts/color-buffer.js';
		import './src/app/scripts/binary.js';
		import './src/app/scripts/fetcher.js';
		import './src/app/scripts/fetching.js';
		import './src/app/scripts/formik.js';
		import './src/app/scripts/report.js';
		import './src/app/scripts/notification.js';
		const update = document.getElementById('update');
		const device = { retries: 0, reload: 10, timeout: null, controller: null, data: null, element: document.getElementById('device') };
		deviceTabs();
		const loadingDevice = (element) => {
			update.children[0].classList.remove('cursor-pointer');
			update.children[0].classList.add('opacity-50', 'cursor-not-allowed');
			update.children[0].onclick = null;
			loading(element.children[0].children[1].children[0], ['w-80', 'h-4'], [], '');
			loading(element.children[1].children[1].children[0], ['w-32', 'h-4'], [], '');
			fade(element.children[2].children[1].children[0]);
			loading(element.children[2].children[1].children[0], ['w-16', 'h-4'], [], '');
			fade(element.children[3].children[1].children[0]);
			loading(element.children[3].children[1].children[0], ['w-16', 'h-4'], [], '');
			fade(element.children[4].children[1].children[0]);
			loading(element.children[4].children[1].children[0], ['w-16', 'h-4'], [], '');
			loading(element.children[5].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[6].children[1].children[0]);
			loading(element.children[6].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[7].children[1].children[0]);
			loading(element.children[7].children[1].children[0], ['w-12', 'h-4'], [], '');
			fade(element.children[8].children[1].children[0]);
			loading(element.children[8].children[1].children[0], ['w-12', 'h-4'], [], '');
			loading(element.children[9].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[10].children[1].children[0]);
			loading(element.children[10].children[1].children[0], ['w-12', 'h-4'], [], '');
			fade(element.children[11].children[1].children[0]);
			loading(element.children[11].children[1].children[0], ['w-12', 'h-4'], [], '');
			loading(element.children[12].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[13].children[1].children[0]);
			loading(element.children[13].children[1].children[0], ['w-12', 'h-4'], [], '');
			fade(element.children[14].children[1].children[0]);
			loading(element.children[14].children[1].children[0], ['w-12', 'h-4'], [], '');
			loading(element.children[15].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[16].children[1].children[0]);
			loading(element.children[16].children[1].children[0], ['w-80', 'h-4'], ['cursor-pointer'], '');
			fade(element.children[17].children[1].children[0]);
			loading(element.children[17].children[1].children[0], ['w-40', 'h-4'], [], '');
		};
		const paintDevice = (element, data) => {
			update.children[0].classList.remove('opacity-50', 'cursor-not-allowed');
			update.children[0].classList.add('cursor-pointer');
			update.children[0].onclick = () => openUpdateDialog(data);
			paint(element.children[0].children[1].children[0], [], ['w-80', 'h-4'], data.id);
			paint(element.children[1].children[1].children[0], [], ['w-32', 'h-4'], data.name);
			fade(element.children[2].children[1].children[0]);
			if (data.zone !== null) {
				paint(element.children[2].children[1].children[0], [], ['w-16', 'h-4'], data.zone.name);
				colorZone(element.children[2].children[1].children[0], data.zone.color);
			} else {
				paint(element.children[2].children[1].children[0], [], ['w-16', 'h-4'], 'null');
				colorNull(element.children[2].children[1].children[0]);
			}
			if (data.firmware !== null) {
				paint(element.children[3].children[1].children[0], [], ['w-16', 'h-4'], data.firmware);
				fade(element.children[3].children[1].children[0]);
			} else {
				paint(element.children[3].children[1].children[0], [], ['w-16', 'h-4'], 'null');
				colorNull(element.children[3].children[1].children[0]);
			}
			if (data.hardware !== null) {
				paint(element.children[4].children[1].children[0], [], ['w-16', 'h-4'], data.hardware);
				fade(element.children[4].children[1].children[0]);
			} else {
				paint(element.children[4].children[1].children[0], [], ['w-16', 'h-4'], 'null');
				colorNull(element.children[4].children[1].children[0]);
			}
			paint(element.children[5].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.createdAt));
			if (data.updatedAt !== null) {
				paint(element.children[6].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.updatedAt));
				fade(element.children[6].children[1].children[0]);
			} else {
				paint(element.children[6].children[1].children[0], [], ['w-40', 'h-4'], 'null');
				colorNull(element.children[6].children[1].children[0]);
			}
			fade(element.children[7].children[1].children[0]);
			fade(element.children[8].children[1].children[0]);
			fade(element.children[9].children[1].children[0]);
			if (data.reading !== null) {
				paint(element.children[7].children[1].children[0], [], ['w-12', 'h-4'], data.reading.temperature.toFixed(2));
				colorTemperature(element.children[7].children[1].children[0], data.reading.temperature);
				paint(element.children[8].children[1].children[0], [], ['w-12', 'h-4'], data.reading.humidity.toFixed(2));
				colorHumidity(element.children[8].children[1].children[0], data.reading.humidity);
				paint(element.children[9].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.reading.capturedAt));
			} else {
				paint(element.children[7].children[1].children[0], [], ['w-12', 'h-4'], 'null');
				colorNull(element.children[7].children[1].children[0]);
				paint(element.children[8].children[1].children[0], [], ['w-12', 'h-4'], 'null');
				colorNull(element.children[8].children[1].children[0]);
				paint(element.children[9].children[1].children[0], [], ['w-40', 'h-4'], 'null');
				colorNull(element.children[9].children[1].children[0]);
			}
			fade(element.children[10].children[1].children[0]);
			fade(element.children[11].children[1].children[0]);
			fade(element.children[12].children[1].children[0]);
			if (data.metric !== null) {
				paint(element.children[10].children[1].children[0], [], ['w-12', 'h-4'], data.metric.photovoltaic.toFixed(3));
				colorPhotovoltaic(element.children[10].children[1].children[0], data.metric.photovoltaic);
				paint(element.children[11].children[1].children[0], [], ['w-12', 'h-4'], data.metric.battery.toFixed(3));
				colorBattery(element.children[11].children[1].children[0], data.metric.battery);
				paint(element.children[12].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.metric.capturedAt));
			} else {
				paint(element.children[10].children[1].children[0], [], ['w-12', 'h-4'], 'null');
				colorNull(element.children[10].children[1].children[0]);
				paint(element.children[11].children[1].children[0], [], ['w-12', 'h-4'], 'null');
				colorNull(element.children[11].children[1].children[0]);
				paint(element.children[12].children[1].children[0], [], ['w-40', 'h-4'], 'null');
				colorNull(element.children[12].children[1].children[0]);
			}
			fade(element.children[13].children[1].children[0]);
			fade(element.children[14].children[1].children[0]);
			fade(element.children[15].children[1].children[0]);
			if (data.buffer !== null) {
				paint(element.children[13].children[1].children[0], [], ['w-12', 'h-4'], duration(data.buffer.delay));
				colorDelay(element.children[13].children[1].children[0], data.buffer.delay);
				paint(element.children[14].children[1].children[0], [], ['w-12', 'h-4'], data.buffer.level);
				colorLevel(element.children[14].children[1].children[0], data.buffer.level);
				paint(element.children[15].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.buffer.capturedAt));
			} else {
				paint(element.children[13].children[1].children[0], [], ['w-12', 'h-4'], 'null');
				colorNull(element.children[13].children[1].children[0]);
				paint(element.children[14].children[1].children[0], [], ['w-12', 'h-4'], 'null');
				colorNull(element.children[14].children[1].children[0]);
				paint(element.children[15].children[1].children[0], [], ['w-40', 'h-4'], 'null');
				colorNull(element.children[15].children[1].children[0]);
			}
			fade(element.children[16].children[1].children[0]);
			fade(element.children[17].children[1].children[0]);
			if (data.uplink !== null) {
				element.children[16].children[1].children[0].classList.add('cursor-pointer');
				element.children[16].children[1].children[0].onclick = () => (window.location.href = `/uplink/${data.uplink.id}`);
				paint(element.children[16].children[1].children[0], ['text-blue-600', 'dark:text-blue-400'], ['w-80', 'h-4'], data.uplink.id);
				paint(element.children[17].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.uplink.receivedAt));
			} else {
				paint(element.children[16].children[1].children[0], [], ['w-80', 'h-4'], 'null');
				colorNull(element.children[16].children[1].children[0]);
				paint(element.children[17].children[1].children[0], [], ['w-40', 'h-4'], 'null');
				colorNull(element.children[17].children[1].children[0]);
			}
		};
		const errorDevice = (element) => {
			update.children[0].classList.remove('cursor-pointer');
			update.children[0].classList.add('opacity-50', 'cursor-not-allowed');
			update.children[0].onclick = null;
			error(element.children[0].children[1].children[0], ['w-80', 'h-4'], [], '');
			error(element.children[1].children[1].children[0], ['w-32', 'h-4'], [], '');
			fade(element.children[2].children[1].children[0]);
			error(element.children[2].children[1].children[0], ['w-16', 'h-4'], [], '');
			fade(element.children[3].children[1].children[0]);
			error(element.children[3].children[1].children[0], ['w-16', 'h-4'], [], '');
			fade(element.children[4].children[1].children[0]);
			error(element.children[4].children[1].children[0], ['w-16', 'h-4'], [], '');
			error(element.children[5].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[6].children[1].children[0]);
			error(element.children[6].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[7].children[1].children[0]);
			error(element.children[7].children[1].children[0], ['w-12', 'h-4'], [], '');
			fade(element.children[8].children[1].children[0]);
			error(element.children[8].children[1].children[0], ['w-12', 'h-4'], [], '');
			error(element.children[9].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[10].children[1].children[0]);
			error(element.children[10].children[1].children[0], ['w-12', 'h-4'], [], '');
			fade(element.children[11].children[1].children[0]);
			error(element.children[11].children[1].children[0], ['w-12', 'h-4'], [], '');
			error(element.children[12].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[13].children[1].children[0]);
			error(element.children[13].children[1].children[0], ['w-12', 'h-4'], [], '');
			fade(element.children[14].children[1].children[0]);
			error(element.children[14].children[1].children[0], ['w-12', 'h-4'], [], '');
			error(element.children[15].children[1].children[0], ['w-40', 'h-4'], [], '');
			fade(element.children[16].children[1].children[0]);
			error(element.children[16].children[1].children[0], ['w-80', 'h-4'], ['cursor-pointer'], '');
			fade(element.children[17].children[1].children[0]);
			error(element.children[17].children[1].children[0], ['w-40', 'h-4'], [], '');
		};
		const parseDevice = async (response) => {
			const buffer = await response.arrayBuffer();
			const binary = new Binary(buffer);
			const device = {
				id: null,
				name: null,
				firmware: null,
				hardware: null,
				createdAt: null,
				updatedAt: null,
				zone: null,
				reading: null,
				metric: null,
				buffer: null,
				uplink: null,
			};
			device.id = binary.uuid();
			device.name = binary.string();
			if (binary.byte() !== 0) {
				device.firmware = binary.string();
			}
			if (binary.byte() !== 0) {
				device.hardware = binary.string();
			}
			device.createdAt = binary.uint(64);
			if (binary.byte() !== 0) {
				device.updatedAt = binary.uint(64);
			}
			if (binary.byte() !== 0) {
				device.zone = {};
				device.zone.id = binary.uuid();
			}
			if (binary.byte() !== 0) {
				device.zone.name = binary.string();
			}
			if (binary.byte() !== 0) {
				device.zone.color = binary.hex(12);
			}
			if (binary.byte() !== 0) {
				device.reading = {};
				device.reading.id = binary.uuid();
			}
			if (binary.byte() !== 0) {
				device.reading.temperature = binary.int(16) / 100;
			}
			if (binary.byte() !== 0) {
				device.reading.humidity = binary.uint(16) / 100;
			}
			if (binary.byte() !== 0) {
				device.reading.capturedAt = binary.uint(64);
			}
			if (binary.byte() !== 0) {
				device.metric = {};
				device.metric.id = binary.uuid();
			}
			if (binary.byte() !== 0) {
				device.metric.photovoltaic = binary.uint(16) / 1000;
			}
			if (binary.byte() !== 0) {
				device.metric.battery = binary.uint(16) / 1000;
			}
			if (binary.byte() !== 0) {
				device.metric.capturedAt = binary.uint(64);
			}
			if (binary.byte() !== 0) {
				device.buffer = {};
				device.buffer.id = binary.uuid();
			}
			if (binary.byte() !== 0) {
				device.buffer.delay = binary.uint(32);
			}
			if (binary.byte() !== 0) {
				device.buffer.level = binary.uint(16);
			}
			if (binary.byte() !== 0) {
				device.buffer.capturedAt = binary.uint(64);
			}
			if (binary.byte() !== 0) {
				device.uplink = {};
				device.uplink.id = binary.uuid();
			}
			if (binary.byte() !== 0) {
				device.uplink.receivedAt = binary.uint(64);
			}
			return device;
		};
		const loadDevice = fetching(
			device,
			(context) => window.requestAnimationFrame(() => loadingDevice(context.element)),
			(context) => fetcher('get', `/api/device/${window.location.pathname.substring(8)}`, null, { controller: context.controller }),
			async (context, response) => (context.data = await parseDevice(response)),
			(context) => window.requestAnimationFrame(() => paintDevice(context.element, context.data)),
			(context) => window.requestAnimationFrame(() => errorDevice(context.element))
		);
		const updateDialog = document.getElementById('update-dialog');
		const openUpdateDialog = (device) => {
			updateForm.setValue('name', device.name);
			document.getElementById('update-name').value = device.name;
			updateForm.setValue('zoneId', device.zone.id);
			document.getElementById('update-zone-id').value = device.zone.id;
			updateForm.setValue('deviceId', device.id);
			updateForm.setTouched('deviceId', true);
			updateDialog.showModal();
		};
		const closeUpdateDialog = () => {
			updateForm.reset();
			updateDialog.close();
		};
		const updateForm = formik(
			{
				button: document.getElementById('update-button'),
				name: document.getElementById('update-name-validation'),
				zoneId: document.getElementById('update-zone-id-validation'),
			},
			{
				name: (value) => {
					if (!value) return 'name is required';
					if (value.length < 2) return 'name is too short';
					if (value.length > 16) return 'name is too long';
					if (!value.match(/^[a-z0-9 ]+$/)) return 'name must be lowercase letters or numbers';
				},
				zoneId: (value) => {
					if (!value) return 'zone id is required';
					if (value.length !== 32) return 'zone id must be 32 characters';
					if (!value.match(/^[0-9a-f]+$/)) return 'zone id must be lowercase hexadecimal';
				},
				deviceId: (value) => {
					if (!value) return 'device id is required';
					if (value.length !== 32) return 'device id must be 32 characters';
					if (!value.match(/^[0-9a-f]+$/)) return 'device id must be lowercase hexadecimal';
				},
			},
			async (values) => {
				const bytes = new Uint8Array(values.zoneId.length / 2);
				for (let ind = 0; ind < bytes.length; ind++) {
					bytes[ind] = parseInt(values.zoneId.substring(ind * 2, ind * 2 + 2), 16);
				}
				const data = new Blob([values.name, '\0', bytes, '\0', '\0']);
				try {
					await fetcher('patch', `/api/device/${values.deviceId}`, data, { headers: { 'content-type': 'application/octet-stream' } });
					notification('success', `Successfully updated device ${values.deviceId.substring(0, 4)}`);
					loadDevice(true);
				} catch (err) {
					report(err);
				}
				closeUpdateDialog();
			}
		);
	</script>
</html>
