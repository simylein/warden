<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="View the latest radio parameters of your device" />
		<title>Warden device radio</title>
		<style></style>
	</head>
	<body
		class="font-sans min-h-dvh flex flex-col m-0 text-base leading-none text-black dark:text-white background-white dark:background-black scheme-light-dark"
		onload="loadRadio()"
	>
		<notifications ref="./src/app/components/notifications.html" />
		<header class="sticky top-0 w-full background-neutral-100 dark:background-neutral-900 z-4">
			<div class="flex items-center justify-between gap-4 sm:gap-6 lg:gap-8 pr-4 sm:pr-6 lg:pr-8 pl-4 sm:pl-6 lg:pl-8">
				<nav class="flex flex-row gap-2 sm:gap-3 lg:gap-4 pt-2 sm:pt-3 lg:pt-4 pb-2 sm:pb-3 lg:pb-4 text-lg font-normal overflow-x-auto scrollbar-none">
					<a href="/" class="no-underline text-black dark:text-white">Home</a>
					<a href="/devices" class="no-underline text-black dark:text-white">Devices</a>
					<a href="/zones" class="no-underline text-black dark:text-white">Zones</a>
					<a href="/uplinks" class="no-underline text-black dark:text-white">Uplinks</a>
					<a href="/downlinks" class="no-underline text-black dark:text-white">Downlinks</a>
					<a href="/users" class="no-underline text-black dark:text-white">Users</a>
				</nav>
				<a href="/profile" class="flex text-black dark:text-white">
					<icon-user ref="./src/app/components/icon-user.html" class="w-5 lg:w-6 h-5 lg:h-6" />
				</a>
			</div>
		</header>
		<main class="flex flex-col grow m-4 sm:m-6 lg:m-8">
			<h1 id="title" class="m-0 w-56 h-4.5 text-lg font-normal background-neutral-200 dark:background-neutral-800"><span></span><span></span><span></span></h1>
			<div
				class="flex flex-row items-center justify-between gap-2 sm:gap-3 lg:gap-4 border-0 border-b-1 border-solid border-b-neutral-400 dark:border-b-neutral-600"
			>
				<div id="tabs" class="flex gap-2 sm:gap-3 lg:gap-4 m-0 pt-2 sm:pt-3 lg:pt-4 pb-2 sm:pb-3 lg:pb-4 text-base font-normal overflow-x-auto scrollbar-none">
					<a class="no-underline text-black dark:text-white">Details</a>
					<a class="no-underline text-black dark:text-white">Readings</a>
					<a class="no-underline text-black dark:text-white">Metrics</a>
					<a class="no-underline text-black dark:text-white">Buffers</a>
					<a class="no-underline text-black dark:text-white">Config</a>
					<a class="no-underline text-blue-600 dark:text-blue-400">Radio</a>
					<a class="no-underline text-black dark:text-white">Signals</a>
					<a class="no-underline text-black dark:text-white">Uplinks</a>
					<a class="no-underline text-black dark:text-white">Downlinks</a>
				</div>
				<div id="update">
					<icon-edit ref="./src/app/components/icon-edit.html" class="w-5 lg:w-6 h-5 lg:h-6 opacity-50 cursor-not-allowed" />
				</div>
			</div>
			<div class="overflow-x-auto scrollbar-none">
				<table class="w-full text-nowrap border-collapse">
					<tbody id="radio">
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Frequency</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-24 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Bandwidth</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-15 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Coding rate</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-3 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Spreading factor</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-4 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Preamble length</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-4 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Tx power</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-4 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Sync word</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="font-mono m-0 w-5 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Checksum</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-8 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
						<tr class="border-solid border-t-0 border-r-0 border-b-1 border-l-0 border-b-neutral-300 dark:border-b-neutral-700">
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4 text-neutral-600 dark:text-neutral-400">
								<p class="m-0">Captured at</p>
							</td>
							<td class="pt-2 sm:pt-3 lg:pt-4 pr-2 sm:pr-3 lg:pr-4 pb-2 sm:pb-3 lg:pb-4">
								<p class="m-0 w-40 h-4 background-neutral-200 dark:background-neutral-800"></p>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			<dialog id="update-dialog" class="w-full max-w-96 lg:max-w-md p-0 border-0 text-black dark:text-white background-neutral-100 dark:background-neutral-900">
				<form class="m-4 flex flex-col gap-4" onsubmit="updateForm.handleSubmit(event)">
					<h1 class="m-0 text-xl font-medium">Update device radio?</h1>
					<div class="flex flex-col lg:flex-row gap-4">
						<div class="w-full flex flex-col gap-4">
							<div class="w-full flex flex-col items-start">
								<label for="update-frequency" class="mb-2 text-base font-normal">Frequency</label>
								<input
									id="update-frequency"
									type="text"
									class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
									placeholder="frequency"
									autofocus
									onchange="updateForm.setValue('frequency', event.target.value)"
									onblur="updateForm.setTouched('frequency', true)"
								/>
								<p id="update-frequency-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
							<div class="w-full flex flex-col items-start">
								<label for="update-bandwidth" class="mb-2 text-base font-normal">Bandwidth</label>
								<input
									id="update-bandwidth"
									type="text"
									class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
									placeholder="bandwidth"
									onchange="updateForm.setValue('bandwidth', event.target.value)"
									onblur="updateForm.setTouched('bandwidth', true)"
								/>
								<p id="update-bandwidth-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
							<div class="w-full flex flex-col items-start">
								<label for="update-coding-rates" class="mb-2 text-base font-normal">Coding rate</label>
								<div id="update-coding-rates" class="w-full flex flex-row gap-2 overflow-x-auto scrollbar-none">
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightCodingRate(document.getElementById('update-coding-rates'), 5); updateForm.setValue('codingRate', 5); updateForm.setTouched('codingRate', true)"
									>
										5
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightCodingRate(document.getElementById('update-coding-rates'), 6); updateForm.setValue('codingRate', 6); updateForm.setTouched('codingRate', true)"
									>
										6
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightCodingRate(document.getElementById('update-coding-rates'), 7); updateForm.setValue('codingRate', 7); updateForm.setTouched('codingRate', true)"
									>
										7
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightCodingRate(document.getElementById('update-coding-rates'), 8); updateForm.setValue('codingRate', 8); updateForm.setTouched('codingRate', true)"
									>
										8
									</button>
								</div>
								<p id="update-coding-rate-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
							<div class="w-full flex flex-col items-start">
								<label for="update-spreading-factors" class="mb-2 text-base font-normal">Spreading factor</label>
								<div id="update-spreading-factors" class="w-full flex flex-row gap-2 overflow-x-auto scrollbar-none">
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 6); updateForm.setValue('spreadingFactor', 6); updateForm.setTouched('spreadingFactor', true)"
									>
										6
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 7); updateForm.setValue('spreadingFactor', 7); updateForm.setTouched('spreadingFactor', true)"
									>
										7
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 8); updateForm.setValue('spreadingFactor', 8); updateForm.setTouched('spreadingFactor', true)"
									>
										8
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 9); updateForm.setValue('spreadingFactor', 9); updateForm.setTouched('spreadingFactor', true)"
									>
										9
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 10); updateForm.setValue('spreadingFactor', 10); updateForm.setTouched('spreadingFactor', true)"
									>
										10
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 11); updateForm.setValue('spreadingFactor', 11); updateForm.setTouched('spreadingFactor', true)"
									>
										11
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightSpreadingFactor(document.getElementById('update-spreading-factors'), 12); updateForm.setValue('spreadingFactor', 12); updateForm.setTouched('spreadingFactor', true)"
									>
										12
									</button>
								</div>
								<p id="update-spreading-factor-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
						</div>
						<div class="w-full flex flex-col gap-4">
							<div class="w-full flex flex-col items-start">
								<label for="update-preamble-length" class="mb-2 text-base font-normal">Preamble length</label>
								<input
									id="update-preamble-length"
									type="text"
									class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
									placeholder="preamble length"
									onchange="updateForm.setValue('preambleLength', event.target.value)"
									onblur="updateForm.setTouched('preambleLength', true)"
								/>
								<p id="update-preamble-length-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
							<div class="w-full flex flex-col items-start">
								<label for="update-tx-power" class="mb-2 text-base font-normal">Tx power</label>
								<input
									id="update-tx-power"
									type="text"
									class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
									placeholder="tx power"
									onchange="updateForm.setValue('txPower', event.target.value)"
									onblur="updateForm.setTouched('txPower', true)"
								/>
								<p id="update-tx-power-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
							<div class="w-full flex flex-col items-start">
								<label for="update-sync-word" class="mb-2 text-base font-normal">Sync word</label>
								<input
									id="update-sync-word"
									type="text"
									class="box-border w-full h-9 p-2 text-base border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800"
									placeholder="sync word"
									onchange="updateForm.setValue('syncWord', event.target.value)"
									onblur="updateForm.setTouched('syncWord', true)"
								/>
								<p id="update-sync-word-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
							<div class="w-full flex flex-col items-start">
								<label for="update-checksum" class="mb-2 text-base font-normal">Checksum</label>
								<div id="update-checksum" class="w-full flex flex-row gap-2 overflow-x-auto scrollbar-none">
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightBoolean(document.getElementById('update-checksum'), false); updateForm.setValue('checksum', false); updateForm.setTouched('checksum', true)"
									>
										false
									</button>
									<button
										type="button"
										class="h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-200 dark:background-neutral-800 outline-none cursor-pointer"
										onclick="highlightBoolean(document.getElementById('update-checksum'), true); updateForm.setValue('checksum', true); updateForm.setTouched('checksum', true)"
									>
										true
									</button>
								</div>
								<p id="update-checksum-validation" class="m-0 mt-2 hidden text-red-600 dark:text-red-400"></p>
							</div>
						</div>
					</div>
					<div class="flex flex-row-reverse justify-start gap-2">
						<button
							id="update-button"
							type="submit"
							class="min-w-28 h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-blue-300 dark:background-blue-700 outline-none cursor-pointer"
						>
							Update
						</button>
						<button
							class="min-w-28 h-8 text-base font-normal pt-1 pr-4 pb-1 pl-4 border-0 text-black dark:text-white background-neutral-300 dark:background-neutral-700 outline-none cursor-pointer"
							type="button"
							onclick="closeUpdateDialog()"
						>
							Cancel
						</button>
					</div>
				</form>
			</dialog>
		</main>
		<footer class="w-full background-neutral-100 dark:background-neutral-900">
			<div
				class="flex flex-row justify-between gap-2 sm:gap-3 lg:gap-4 pt-2 sm:pt-3 lg:pt-4 pr-4 sm:pr-6 lg:pr-8 pb-2 sm:pb-3 lg:pb-4 pl-4 sm:pl-6 lg:pl-8 text-lg font-normal text-nowrap overflow-x-auto scrollbar-none"
			>
				<p class="m-0 text-xs font-normal text-neutral-400 dark:text-neutral-600">warden {version} {commit}</p>
				<p class="m-0 text-xs font-normal text-neutral-400 dark:text-neutral-600">written by simylein</p>
			</div>
		</footer>
	</body>
	<script>
		import './src/app/scripts/array.js';
		import './src/app/scripts/duration.js';
		import './src/app/scripts/device-tabs.js';
		import './src/app/scripts/device-title.js';
		import './src/app/scripts/state.js';
		import './src/app/scripts/timestamp.js';
		import './src/app/scripts/fade.js';
		import './src/app/scripts/color-null.js';
		import './src/app/scripts/color-cr.js';
		import './src/app/scripts/color-sf.js';
		import './src/app/scripts/color-preamble-len.js';
		import './src/app/scripts/color-tx-power.js';
		import './src/app/scripts/color-boolean.js';
		import './src/app/scripts/binary.js';
		import './src/app/scripts/fetcher.js';
		import './src/app/scripts/fetching.js';
		import './src/app/scripts/formik.js';
		import './src/app/scripts/report.js';
		import './src/app/scripts/notification.js';
		const title = document.getElementById('title');
		const update = document.getElementById('update');
		const radio = { retries: 0, reload: 10, timeout: null, controller: null, data: null, response: null, element: document.getElementById('radio') };
		deviceTabs();
		const loadingRadio = (element) => {
			update.children[0].classList.remove('cursor-pointer');
			update.children[0].classList.add('opacity-50', 'cursor-not-allowed');
			update.children[0].onclick = null;
			loading(element.children[0].children[1].children[0], ['w-24', 'h-4'], [], '');
			loading(element.children[1].children[1].children[0], ['w-15', 'h-4'], [], '');
			loading(element.children[2].children[1].children[0], ['w-3', 'h-4'], [], '');
			loading(element.children[3].children[1].children[0], ['w-4', 'h-4'], [], '');
			loading(element.children[4].children[1].children[0], ['w-4', 'h-4'], [], '');
			loading(element.children[5].children[1].children[0], ['w-4', 'h-4'], [], '');
			loading(element.children[6].children[1].children[0], ['w-5', 'h-4'], [], '');
			loading(element.children[7].children[1].children[0], ['w-8', 'h-4'], [], '');
			loading(element.children[8].children[1].children[0], ['w-40', 'h-4'], [], '');
		};
		const paintRadio = (element, data) => {
			update.children[0].classList.remove('opacity-50', 'cursor-not-allowed');
			update.children[0].classList.add('cursor-pointer');
			update.children[0].onclick = () => openUpdateDialog(data);
			if (data.frequency !== null) {
				paint(element.children[0].children[1].children[0], [], ['w-24', 'h-4'], data.frequency);
				fade(element.children[0].children[1].children[0]);
			} else {
				paint(element.children[0].children[1].children[0], [], ['w-24', 'h-4'], 'null');
				colorNull(element.children[0].children[1].children[0]);
			}
			if (data.bandwidth !== null) {
				paint(element.children[1].children[1].children[0], [], ['w-15', 'h-4'], data.bandwidth);
				fade(element.children[1].children[1].children[0]);
			} else {
				paint(element.children[1].children[1].children[0], [], ['w-15', 'h-4'], 'null');
				colorNull(element.children[1].children[1].children[0]);
			}
			if (data.codingRate !== null) {
				paint(element.children[2].children[1].children[0], [], ['w-3', 'h-4'], data.codingRate);
				colorCr(element.children[2].children[1].children[0], data.codingRate);
			} else {
				paint(element.children[2].children[1].children[0], [], ['w-3', 'h-4'], 'null');
				colorNull(element.children[2].children[1].children[0]);
			}
			if (data.spreadingFactor !== null) {
				paint(element.children[3].children[1].children[0], [], ['w-4', 'h-4'], data.spreadingFactor);
				colorSf(element.children[3].children[1].children[0], data.spreadingFactor);
			} else {
				paint(element.children[3].children[1].children[0], [], ['w-4', 'h-4'], 'null');
				colorNull(element.children[3].children[1].children[0]);
			}
			if (data.preambleLength !== null) {
				paint(element.children[4].children[1].children[0], [], ['w-4', 'h-4'], data.preambleLength);
				colorPreambleLen(element.children[4].children[1].children[0], data.preambleLength);
			} else {
				paint(element.children[4].children[1].children[0], [], ['w-4', 'h-4'], 'null');
				colorNull(element.children[4].children[1].children[0]);
			}
			if (data.txPower !== null) {
				paint(element.children[5].children[1].children[0], [], ['w-4', 'h-4'], data.txPower);
				colorTxPower(element.children[5].children[1].children[0], data.txPower);
			} else {
				paint(element.children[5].children[1].children[0], [], ['w-4', 'h-4'], 'null');
				colorNull(element.children[5].children[1].children[0]);
			}
			if (data.syncWord !== null) {
				paint(element.children[6].children[1].children[0], [], ['w-5', 'h-4'], data.syncWord);
				fade(element.children[6].children[1].children[0]);
			} else {
				paint(element.children[6].children[1].children[0], [], ['w-5', 'h-4'], 'null');
				colorNull(element.children[6].children[1].children[0]);
			}
			if (data.checksum !== null) {
				paint(element.children[7].children[1].children[0], [], ['w-8', 'h-4'], data.checksum);
				colorBoolean(element.children[7].children[1].children[0], data.checksum);
			} else {
				paint(element.children[7].children[1].children[0], [], ['w-8', 'h-4'], 'null');
				colorNull(element.children[7].children[1].children[0]);
			}
			if (data.capturedAt !== null) {
				paint(element.children[8].children[1].children[0], [], ['w-40', 'h-4'], timestamp(data.capturedAt));
				fade(element.children[8].children[1].children[0]);
			} else {
				paint(element.children[8].children[1].children[0], [], ['w-40', 'h-4'], 'null');
				colorNull(element.children[8].children[1].children[0]);
			}
		};
		const errorRadio = (element) => {
			update.children[0].classList.remove('cursor-pointer');
			update.children[0].classList.add('opacity-50', 'cursor-not-allowed');
			update.children[0].onclick = null;
			error(element.children[0].children[1].children[0], ['w-24', 'h-4'], [], '');
			error(element.children[1].children[1].children[0], ['w-15', 'h-4'], [], '');
			error(element.children[2].children[1].children[0], ['w-3', 'h-4'], [], '');
			error(element.children[3].children[1].children[0], ['w-4', 'h-4'], [], '');
			error(element.children[4].children[1].children[0], ['w-4', 'h-4'], [], '');
			error(element.children[5].children[1].children[0], ['w-4', 'h-4'], [], '');
			error(element.children[6].children[1].children[0], ['w-5', 'h-4'], [], '');
			error(element.children[7].children[1].children[0], ['w-8', 'h-4'], [], '');
			error(element.children[8].children[1].children[0], ['w-40', 'h-4'], [], '');
		};
		const parseRadio = async (response) => {
			const buffer = await response.arrayBuffer();
			const binary = new Binary(buffer);
			const radio = {
				frequency: null,
				bandwidth: null,
				codingRate: null,
				spreadingFactor: null,
				preambleLength: null,
				txPower: null,
				syncWord: null,
				checksum: null,
				capturedAt: null,
			};
			if (response.status !== 204) {
				radio.frequency = binary.uint(32);
				radio.bandwidth = binary.uint(32);
				radio.codingRate = binary.uint(8);
				radio.spreadingFactor = binary.uint(8);
				radio.preambleLength = binary.uint(8);
				radio.txPower = binary.uint(8);
				radio.syncWord = binary.hex(1);
				radio.checksum = binary.bool();
				radio.capturedAt = binary.uint(64);
			}
			return radio;
		};
		const loadRadio = fetching(
			radio,
			(context) => {
				loadingDeviceTitle(title);
				window.requestAnimationFrame(() => loadingRadio(context.element));
			},
			(context) => fetcher('get', `/api/device/${window.location.pathname.substring(8)}`, null, { controller: context.controller }),
			async (context, response) => {
				context.data = await parseRadio(response);
				context.response = response;
			},
			(context) => {
				paintDeviceTitle(title, context.response);
				window.requestAnimationFrame(() => paintRadio(context.element, context.data));
			},
			(context) => {
				errorDeviceTitle(title);
				window.requestAnimationFrame(() => errorRadio(context.element));
			}
		);
		const highlightCodingRate = (element, codingRate) => {
			array(element.children.length).forEach((ind) => {
				fade(element.children[ind]);
				element.children[ind].classList.add('text-black', 'dark:text-white', 'background-neutral-200', 'dark:background-neutral-800');
			});
			switch (codingRate) {
				case 5:
					fade(element.children[0]);
					element.children[0].classList.add('text-green-600', 'dark:text-green-400', 'background-green-100', 'dark:background-green-900');
					break;
				case 6:
					fade(element.children[1]);
					element.children[1].classList.add('text-teal-600', 'dark:text-teal-400', 'background-teal-100', 'dark:background-teal-900');
					break;
				case 7:
					fade(element.children[2]);
					element.children[2].classList.add('text-sky-600', 'dark:text-sky-400', 'background-sky-100', 'dark:background-sky-900');
					break;
				case 8:
					fade(element.children[3]);
					element.children[3].classList.add('text-indigo-600', 'dark:text-indigo-400', 'background-indigo-100', 'dark:background-indigo-900');
					break;
			}
		};
		const highlightSpreadingFactor = (element, spreadingFactor) => {
			array(element.children.length).forEach((ind) => {
				fade(element.children[ind]);
				element.children[ind].classList.add('text-black', 'dark:text-white', 'background-neutral-200', 'dark:background-neutral-800');
			});
			switch (spreadingFactor) {
				case 6:
					fade(element.children[0]);
					element.children[0].classList.add('text-green-600', 'dark:text-green-400', 'background-green-100', 'dark:background-green-900');
					break;
				case 7:
					fade(element.children[1]);
					element.children[1].classList.add('text-emerald-600', 'dark:text-emerald-400', 'background-emerald-100', 'dark:background-emerald-900');
					break;
				case 8:
					fade(element.children[2]);
					element.children[2].classList.add('text-teal-600', 'dark:text-teal-400', 'background-teal-100', 'dark:background-teal-900');
					break;
				case 9:
					fade(element.children[3]);
					element.children[3].classList.add('text-cyan-600', 'dark:text-cyan-400', 'background-cyan-100', 'dark:background-cyan-900');
					break;
				case 10:
					fade(element.children[4]);
					element.children[4].classList.add('text-sky-600', 'dark:text-sky-400', 'background-sky-100', 'dark:background-sky-900');
					break;
				case 11:
					fade(element.children[5]);
					element.children[5].classList.add('text-blue-600', 'dark:text-blue-400', 'background-blue-100', 'dark:background-blue-900');
					break;
				case 12:
					fade(element.children[6]);
					element.children[6].classList.add('text-indigo-600', 'dark:text-indigo-400', 'background-indigo-100', 'dark:background-indigo-900');
					break;
			}
		};
		const highlightBoolean = (element, value) => {
			array(element.children.length).forEach((ind) => {
				fade(element.children[ind]);
				element.children[ind].classList.add('text-black', 'dark:text-white', 'background-neutral-200', 'dark:background-neutral-800');
			});
			switch (value) {
				case false:
					fade(element.children[0]);
					element.children[0].classList.add('text-red-600', 'dark:text-red-400', 'background-red-100', 'dark:background-red-900');
					break;
				case true:
					fade(element.children[1]);
					element.children[1].classList.add('text-green-600', 'dark:text-green-400', 'background-green-100', 'dark:background-green-900');
					break;
			}
		};
		const updateDialog = document.getElementById('update-dialog');
		const openUpdateDialog = (radio) => {
			if (radio.frequency !== null) {
				updateForm.setValue('frequency', `${radio.frequency}`);
				document.getElementById('update-frequency').value = radio.frequency;
			}
			if (radio.bandwidth !== null) {
				updateForm.setValue('bandwidth', `${radio.bandwidth}`);
				document.getElementById('update-bandwidth').value = radio.bandwidth;
			}
			if (radio.codingRate !== null) {
				updateForm.setValue('codingRate', `${radio.codingRate}`);
			}
			highlightCodingRate(document.getElementById('update-coding-rates'), radio.codingRate);
			if (radio.spreadingFactor !== null) {
				updateForm.setValue('spreadingFactor', `${radio.spreadingFactor}`);
			}
			highlightSpreadingFactor(document.getElementById('update-spreading-factors'), radio.spreadingFactor);
			if (radio.preambleLength !== null) {
				updateForm.setValue('preambleLength', `${radio.preambleLength}`);
				document.getElementById('update-preamble-length').value = radio.preambleLength;
			}
			if (radio.txPower !== null) {
				updateForm.setValue('txPower', `${radio.txPower}`);
				document.getElementById('update-tx-power').value = radio.txPower;
			}
			if (radio.syncWord !== null) {
				updateForm.setValue('syncWord', radio.syncWord);
				document.getElementById('update-sync-word').value = radio.syncWord;
			}
			if (radio.checksum !== null) {
				updateForm.setValue('checksum', radio.checksum);
			}
			highlightBoolean(document.getElementById('update-checksum'), radio.checksum);
			updateDialog.showModal();
		};
		const closeUpdateDialog = () => {
			updateForm.reset();
			updateDialog.close();
		};
		const updateForm = formik(
			{
				button: document.getElementById('update-button'),
				frequency: document.getElementById('update-frequency-validation'),
				bandwidth: document.getElementById('update-bandwidth-validation'),
				codingRate: document.getElementById('update-coding-rate-validation'),
				spreadingFactor: document.getElementById('update-spreading-factor-validation'),
				preambleLength: document.getElementById('update-preamble-length-validation'),
				txPower: document.getElementById('update-tx-power-validation'),
				syncWord: document.getElementById('update-sync-word-validation'),
				checksum: document.getElementById('update-checksum-validation'),
			},
			{
				frequency: (value) => {
					if (!value) return 'frequency is required';
					if (!value.match(/^[0-9]+$/)) return 'frequency must be a number';
					if (+value < 430000000) return 'frequency must be min 430000000';
					if (+value > 440000000) return 'frequency must be max 440000000';
				},
				bandwidth: (value) => {
					if (!value) return 'bandwidth is required';
					if (!value.match(/^[0-9]+$/)) return 'bandwidth must be a number';
					if (+value < 7800) return 'bandwidth must be min 7800';
					if (+value > 500000) return 'bandwidth must be max 500000';
				},
				codingRate: (value) => {
					if (!value) return 'coding rate is required';
					if (value < 5) return 'coding rate must be min 5';
					if (value > 8) return 'coding rate must be max 8';
				},
				spreadingFactor: (value) => {
					if (!value) return 'spreading factor is required';
					if (value < 6) return 'spreading factor must be min 6';
					if (value > 12) return 'spreading factor must be max 12';
				},
				preambleLength: (value) => {
					if (!value) return 'preamble length is required';
					if (!value.match(/^[0-9]+$/)) return 'preamble length must be a number';
					if (+value < 6) return 'preamble length must be min 6';
					if (+value > 21) return 'preamble length must be max 21';
				},
				txPower: (value) => {
					if (!value) return 'tx power is required';
					if (!value.match(/^[0-9]+$/)) return 'tx power must be a number';
					if (+value < 2) return 'tx power must be min 2';
					if (+value > 17) return 'tx power must be max 17';
				},
				syncWord: (value) => {
					if (!value) return 'sync word is required';
					if (value.length !== 2) return 'sync word must be 2 characters';
					if (!value.match(/^[0-9a-f]+$/)) return 'sync word must be lowercase hexadecimal';
				},
				checksum: (value) => {
					if (value === null) return 'checksum is required';
					if (value !== false && value !== true) return 'checksum must be a boolean';
				},
			},
			async (values) => {
				const bytes = new Uint8Array(14);
				const view = new DataView(bytes.buffer);
				view.setUint32(0, values.frequency);
				view.setUint32(4, values.bandwidth);
				view.setUint8(8, values.codingRate);
				view.setUint8(9, values.spreadingFactor);
				view.setUint8(10, values.preambleLength);
				view.setUint8(11, values.txPower);
				view.setUint8(12, parseInt(values.syncWord, 16));
				view.setUint8(13, values.checksum);
				const data = new Blob([bytes]);
				try {
					await fetcher('patch', `/api/device/${window.location.pathname.substring(8)}`, data, { headers: { 'content-type': 'application/octet-stream' } });
					notification('success', `Successfully updated device radio ${values.deviceId.substring(0, 4)}`);
				} catch (err) {
					report(err);
				}
				closeUpdateDialog();
			}
		);
	</script>
</html>
